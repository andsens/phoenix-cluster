[Unit]
Description=Write the Raspberry PI 5 OTP secret to ramdisk
DefaultDependencies=no
Before=random-secret.service surrogate-key.service
ConditionPathExists=!/run/initramfs/random-secret.bin

[Install]
RequiredBy=surrogate-key.service

[Service]
Type=oneshot
RemainAfterExit=yes
ExecStart=rpi-otp-private-key -c
ExecStart=bash -ec 'rpi-otp-private-key -l 16 -b >/run/initramfs/random-secret.bin'
ExecStart=set-node-state keys.random-secret.source rpi-otp
