apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: traefik
resources:
- ../cluster-vars
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.containo.us_ingressroutes.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.containo.us_ingressroutetcps.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.containo.us_ingressrouteudps.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.containo.us_middlewares.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.containo.us_middlewaretcps.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.containo.us_serverstransports.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.containo.us_tlsoptions.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.containo.us_tlsstores.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.containo.us_traefikservices.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_ingressroutes.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_ingressroutetcps.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_ingressrouteudps.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_middlewares.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_middlewaretcps.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_serverstransports.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_serverstransporttcps.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_tlsoptions.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_tlsstores.yaml
- https://raw.githubusercontent.com/traefik/traefik-helm-chart/master/traefik/crds/traefik.io_traefikservices.yaml
- namespace.yaml
- traefik.yaml
- networkpolicy.yaml
- dashboard-ingress.yaml
- Kptfile
- resourcegroup.yaml
patches:
- patch: |-
    apiVersion: v1
    kind: ConfigMap
    metadata: {name: cluster-vars, annotations: {config.kubernetes.io/local-config: "true"}}
configMapGenerator:
- files:
  - config/file-provider.yaml
  - config/traefik.yaml
  name: traefik
generatorOptions:
  disableNameSuffixHash: true
replacements:
- source: {fieldPath: data.DOMAIN, kind: ConfigMap, name: cluster-vars}
  targets:
  - select: {group: networking.k8s.io, kind: Ingress, name: traefik-dashboard}
    fieldPaths: [spec.tls.0.hosts.0]
  - select: {group: networking.k8s.io, kind: Ingress, name: traefik-dashboard}
    fieldPaths: [spec.rules.0.host]
- source: {fieldPath: data.ACME_PROVIDER, kind: ConfigMap, name: cluster-vars}
  targets:
  - select: {group: networking.k8s.io, kind: Ingress, name: traefik-dashboard}
    fieldPaths: [metadata.annotations.cert-manager\.io/cluster-issuer]
